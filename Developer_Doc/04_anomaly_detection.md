# ๐จ anomaly_detection.py โ ุชุดุฎุต ูุงููุฌุงุฑ ุฏุฑ ูุฑูุด ุฑูุฒุงูู

ุงู ูุงฺูู ูุณุฆูู ูพุฏุง ฺฉุฑุฏู ุฑูุฒูุง ุงุณุช ฺฉู ูุฑูุด ุจูโุตูุฑุช ุบุฑุนุงุฏ ุฒุงุฏ ุง ฺฉู ุจูุฏู ุงุณุช.

ุชูุฑฺฉุฒ ุงู ูุงู ุฑู:

๐ง ุงุฏฺฏุฑ ุงูฺฏููุง ุนุงุฏ ูุฑูุด  
๐ ุดูุงุณุง ุฌูุดโูุง ุง ุณููุทโูุง ุบุฑููุชุธุฑู  
๐ ุณุงุฎุช ฺฏุฒุงุฑุด ุนุฏุฏ  
๐ผ๏ธ ุชููุฏ ูููุฏุงุฑ ุชุตูุฑ  

---

# ๐ฏ ูุฏู ุงู ูุงฺูู ฺุณุชุ

ุฏุฑ ุณุณุชูโูุง ูุงูุน Retail Analyticsุ ฺฉุดู ูุงููุฌุงุฑ ุจุฑุง:

- ุชููุจ ุงุญุชูุงู ๐ณ
- ุงุฎุชูุงู ุณุณุชู ูุฑูุด โ๏ธ
- ฺฉููพู ุชุจูุบุงุช ุบุฑููุชุธุฑู ๐ฃ
- ุจุญุฑุงู ูุฌุณุชฺฉ ๐
- ุชุนุทู ุง ุดูฺฉ ุจุงุฒุงุฑ ๐งจ

ุงุณุชูุงุฏู ูโุดูุฏ.

ุงู ูุงู ูุณุฎูโ ุชุฎุตุตโุชุฑ anomaly detection ูุณุจุช ุจู ุชุญูู ุนููู ุฏุงุฎู `analysis.py` ุงุณุช.

---

# ๐งญ ุฌุงฺฏุงู ุฏุฑ Pipeline

data/clean/daily_sales.csv
โ
anomaly_detection.py
โ
output/
โโโ anomalies.csv
โโโ anomaly_plot.png

---

# ๐ ฺฉุฏ ฺฉุงูู

```python
df = pd.read_csv("data/clean/daily_sales.csv")
df["Date"] = pd.to_datetime(df["Date"])
df = df.sort_values("Date")
```

ุงู ุจุฎุด:

โ๏ธ ุฏุงุฏูโ ุชูุฒุดุฏู ุฑุง ูโุฎูุงูุฏ
โ๏ธ ุชุงุฑุฎ ุฑุง ุจู datetime ุชุจุฏู ูโฺฉูุฏ
โ๏ธ ูุฑุชุจโุณุงุฒ ุฒูุงู ุงูุฌุงู ูโุฏูุฏ

---

# ๐งฉ Feature Engineering (ูููุฏุณ ูฺฺฏ)

ูุฏู Isolation Forest ููุท ุนุฏุฏ ูโูููุฏโูพุณ ูุง ุจุงุฏ ุณฺฏูุงู ุฒูุงู ุจุณุงุฒู.

---

## ๐ ูุงูฺฏู ูุชุญุฑฺฉ ทุฑูุฒู

```
df["rolling_mean_7"] = df["TotalPrice"].rolling(7).mean()
```

ุงู ุฎุท:

ูุงูฺฏู ูุฑูุด ููุชูโ ุงุฎุฑ ุฑุง ูโุณุงุฒุฏ.

ูุซู ุฏุฏู ุจุงุฒุงุฑ ุจุง ุนูฺฉ ูุฑูโฺฉููุฏูโ ููุณุงูโูุง ๐๐

---

## ๐ ุงูุญุฑุงู ูุนุงุฑ ทุฑูุฒู

```
df["rolling_std_7"] = df["TotalPrice"].rolling(7).std()
```

ูุฒุงู ููุณุงู ููุชูโ ุงุฎุฑ ุฑุง ุงูุฏุงุฒู ูโฺฏุฑุฏ.

---

## ๐งน ุญุฐู NaN

```
df = df.dropna()
```

ท ุฑูุฒ ุงูู rolling ูุฏุงุฑูุฏโูพุณ ุญุฐู ูโุดููุฏ.

---

## ๐ฏ ูุงุชุฑุณ ูฺฺฏโูุง

```
features = df[["TotalPrice", "rolling_mean_7", "rolling_std_7"]]
```

ุณู ุจุนุฏ:

- ูุฑูุด ูุงูุน

- ุฑููุฏ ฺฉูุชุงูโูุฏุช

- ูุฒุงู ููุณุงู

---

# ๐ฒ ุขููุฒุด Isolation Forest

---

## ๐ค ุชุนุฑู ูุฏู

```
model = IsolationForest(
    n_estimators=200,
    contamination=0.02,
    random_state=42
)
```

ูุนู ูพุงุฑุงูุชุฑูุง:

- n_estimators โ ุชุนุฏุงุฏ ุฏุฑุฎุชโูุง ๐ณ

- contamination โ ุฏุฑุตุฏ ุฏุงุฏูโูุง ูุดฺฉูฺฉ (ฒูช)

- random_state โ ุชฺฉุฑุงุฑูพุฐุฑ

- Isolation Forest ููุงุท ุนุฌุจ ุฑุง ุจุง ุงุฒูููโฺฉุฑุฏู ุณุฑุน ุชุดุฎุต ูโุฏูุฏโูู ุจุง ูุฏูโฺฉุฑุฏู ุชูุฒุน.

---

## ๐ฉ ุจุฑฺุณุจโฺฏุฐุงุฑ

```
df["anomaly"] = model.fit_predict(features)
df["is_anomaly"] = df["anomaly"] == -1
```

ุทุจู ูุฑุงุฑุฏุงุฏ sklearn:

- -1 โ ูุงููุฌุงุฑ

- 1 โ ูุฑูุงู

---

# ๐พ ุฐุฎุฑู ูุชุงุฌ

---

```
df[df["is_anomaly"]].to_csv("output/anomalies.csv")
```

ุฎุฑูุฌ ุดุงูู:

๐ ุชุงุฑุฎ
๐ฐ ูุฑูุด
๐ rolling mean
๐ rolling std

---

# ๐ ุฑุณู ูููุฏุงุฑ ูุงููุฌุงุฑโูุง

---

## ๐ ุฎุท ูุฑูุด

```
plt.plot(df["Date"], df["TotalPrice"])
```

## ๐ด ููุงุท ูุดฺฉูฺฉ

```
plt.scatter(
    df[df["is_anomaly"]]["Date"],
    df[df["is_anomaly"]]["TotalPrice"],
)
```
ุงูโูุง ุฑูุฒูุง ูุณุชูุฏ ฺฉู ูุฏู ฺฏูุชู:

ยซุงู ฺฉ ุจู ุนูู ุนุฌุจ ูโุฏูุฏยป ๐งช

---

## ๐ผ๏ธ ุฐุฎุฑู ุชุตูุฑ

```
output/anomaly_plot.png
```

---

## ๐ฅ ูุฑูุฏโูุง ู ๐ค ุฎุฑูุฌโูุง 

ูุฑูุฏ

- data/clean/daily_sales.csv

ุฎุฑูุฌ

ุฏุฑ ูููุฏุฑ output/:

๐ anomalies.csv
๐ผ anomaly_plot.png

---

# ๐ง ฺุฑุง ุงู ุฑูุด ุงูุชุฎุงุจ ุดุฏูุ

Isolation Forest:

โ๏ธ ุจุฏูู ูุงุฒ ุจู ุจุฑฺุณุจ
โ๏ธ ููุงุณุจ ุฏุงุฏูโูุง ุจุฒุฑฺฏ
โ๏ธ ููุงูู ุฏุฑ ุจุฑุงุจุฑ ููุฒ
โ๏ธ ุฎูุจ ุจุฑุง ุณุฑโูุง ุฒูุงู ุณุงุฏู

Rolling features ุจุงุนุซ ูโุดููุฏ ูุฏู:

๐ ุฑููุฏ ฺฉูุชุงูโูุฏุช ุฑุง ุจุจูุฏ
๐ ูุฒุงู ููุณุงู ุฑุง ุญุณ ฺฉูุฏ
๐ ุชูุงูุช ุฑูุฒูุง ุนุงุฏ ู ุบุฑุนุงุฏ ุฑุง ุจูููุฏ

---

# ๐ ูุณุฎู ุตูุนุชโุชุฑ ฺู ูโุดูุฏุ

ุฏุฑ ูุญุตูู ูุงูุน:

- STL decomposition ุงุถุงูู ูโุดูุฏ

- Prophet / LSTM ุชุณุช ูโุดูุฏ

- threshold ูพูุง ูโุดูุฏ

- ุฏุงุดุจูุฑุฏ ุจูุงุฏุฑูฺฏ ุณุงุฎุชู ูโุดูุฏ

- ูุดุฏุงุฑ ุงูู ุง Slack ๐จ

---

# โ ุฌูุนโุจูุฏ

ุงู ูุงฺูู:

โ๏ธ ูุงููุฌุงุฑ ุฒูุงู ูพุฏุง ูโฺฉูุฏ
โ๏ธ ูฺฺฏ ูููุฏุณโุดุฏู ุฏุงุฑุฏ
โ๏ธ ุฎุฑูุฌ ุชุตูุฑ ูโุฏูุฏ
โ๏ธ ูุงุจู ุงุชุตุงู ุจู ุฏุงุดุจูุฑุฏ ุงุณุช
โ๏ธ ูพุงู ุณุณุชู ูุดุฏุงุฑุฏู ุงุณุช