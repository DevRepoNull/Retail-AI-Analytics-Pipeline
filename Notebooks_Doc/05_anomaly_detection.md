# ๐จ 05_anomaly_detection.ipynb โ ุชุดุฎุต ูุงููุฌุงุฑโูุง ุฏุฑ ุชุฑุงฺฉูุดโูุง

ุงู ููุชโุจูฺฉ ุจุฑุง ุดูุงุณุง **ุชุฑุงฺฉูุดโูุง ุบุฑูุนููู ุง ูุงููุฌุงุฑ** ุจุง ุงุณุชูุงุฏู ุงุฒ **Isolation Forest** ุงุณุชูุงุฏู ูโุดูุฏ.

---

## ๐ ุจุฎุด 1 โ ุจุงุฑฺฏุฐุงุฑ ฺฉุชุงุจุฎุงูู ู ุฏุงุฏูโูุง

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

from sklearn.ensemble import IsolationForest

df = pd.read_csv("../data/clean/retail_clean.csv")
df['InvoiceDate'] = pd.to_datetime(df['InvoiceDate'])
```

- pandas / numpy โ ูุฏุฑุช ุฏุงุฏู

- matplotlib / seaborn โ ุฑุณู ูููุฏุงุฑ

- sklearn โ ูุฏู Isolation Forest ุจุฑุง ุชุดุฎุต ูุงููุฌุงุฑ

- ุฏุงุฏู ุชูุฒ ุดุฏู ุจุงุฑฺฏุฐุงุฑ ู ุณุชูู ุชุงุฑุฎ ุจู datetime ุชุจุฏู ุดุฏ

---

## ๐ ุจุฎุด 2 โ ุงูุชุฎุงุจ ูฺฺฏโูุง

```
X = df[['Quantity', 'TotalPrice']]
```

- ุชูุฑฺฉุฒ ุจุฑ ูฺฺฏโูุง ูุงู ู ุชุนุฏุงุฏ ฺฉุงูุงูุง

- Quantity โ ุชุนุฏุงุฏ ุขุชูโูุง ุฎุฑุฏุงุฑ ุดุฏู

- TotalPrice โ ูุจูุบ ฺฉู ุชุฑุงฺฉูุด

---

## ๐ ุจุฎุด 3 โ ุขููุฒุด Isolation Forest

```
iso_forest = IsolationForest(
    n_estimators=200,
    contamination=0.01,  # 1% ุฏุงุฏูโูุง ูุงููุฌุงุฑ ูุฑุถ ูโุดููุฏ
    random_state=42
)
iso_forest.fit(X)
df['Anomaly'] = iso_forest.predict(X)
```

- ูุฏู Isolation Forest ุจุง ฒฐฐ ุฏุฑุฎุช ุขููุฒุด ุฏุงุฏู ุดุฏ

- ฑูช ุฏุงุฏูโูุง ุจู ุนููุงู ูุงููุฌุงุฑ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏ

- ุณุชูู Anomaly: ฑ โ ูุฑูุงูุ -1 โ ูุงููุฌุงุฑ

---

## ๐ ุจุฎุด 4 โ ุจุฑุฑุณ ุชุนุฏุงุฏ ูุงููุฌุงุฑโูุง

```
print(df['Anomaly'].value_counts())
```

- ููุงุด ุชุนุฏุงุฏ ุชุฑุงฺฉูุดโูุง ูุฑูุงู ู ุบุฑูุนููู

- ุจุฑุฑุณ ุตุญุช ูุฏู ู ูุณุจุช ูุงููุฌุงุฑโูุง

---

## ๐ ุจุฎุด 5 โ ูููุฏุงุฑ ูุงููุฌุงุฑโูุง

```
plt.figure(figsize=(10,6))
sns.scatterplot(
    x='Quantity', y='TotalPrice',
    hue='Anomaly', data=df, palette={1:'blue', -1:'red'},
    alpha=0.6
)
plt.title("Anomaly Detection in Transactions")
plt.show()
```

- ููุงุด ุชุฑุงฺฉูุดโูุง ุฏุฑ ูุถุง Quantity vs TotalPrice

- ุฑูฺฏ ูุฑูุฒ โ ูุงููุฌุงุฑุ ุฑูฺฏ ุขุจ โ ูุฑูุงู

- ุจุฑุฑุณ ุจุตุฑ ุชุฑุงฺฉูุดโูุง ุบุฑูุนููู

---

# โ ุฌูุนโุจูุฏ

anomaly_detection:

- ุฏุงุฏู ุชุฑุงฺฉูุดโูุง ุฑุง ุจุฑุง ุชุดุฎุต ูุงููุฌุงุฑ ุขูุงุฏู ูโฺฉูุฏ

- ูฺฺฏโูุง ฺฉูุฏ (Quantity ู TotalPrice) ุฑุง ุงูุชุฎุงุจ ูโฺฉูุฏ

- ูุฏู Isolation Forest ุฑุง ุขููุฒุด ูโุฏูุฏ ู ูุงููุฌุงุฑโูุง ุฑุง ูพุดโุจู ูโฺฉูุฏ

- ุชุนุฏุงุฏ ูุงููุฌุงุฑโูุง ุฑุง ุจุฑุฑุณ ู ุขููุง ุฑุง ุจุตุฑ ูโฺฉูุฏ

- ุฎุฑูุฌ ุขูุงุฏู ุงุณุชูุงุฏู ุฏุฑ ุฏุงุดุจูุฑุฏ ุง ุชุญููโูุง ุจุนุฏ